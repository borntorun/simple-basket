/*!
 * simple-basket - A simple javascript basket for values.
 * 
 * Copyright (c) 2015 JoÃ£o Carvalho (https://github.com/borntorun)
 * Licensed under MIT license
 *     See https://github.com/borntorun/simple-basket/blob/master/LICENSE
 * v0.3.1
 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["_"],function(a){return b(a)}):"object"==typeof exports?module.exports=b(require("lodash")):a.simplebasket=b(a._)}(this,function(a){"use strict";function b(a,b){var c=[].slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function c(b){var c=[],d=b||{};this.add=function(){var a;a=1===arguments.length&&f(arguments[0])?[].slice.call(arguments[0]):[].slice.call(arguments);var b=d[k.UNIQUEKEY];return a.forEach(function(a){b&&"object"==typeof a&&j(a,b)&&this.find({key:b,value:a[b]}).length||c.push(a)},this),this},this.set=function(b){return f(b)!==!1?(this.add.apply(this,a.clone(b,!0)),this):void 0},this.getClone=function(){return a.clone(c,!0)},this.getAll=function(){return c},this.remove=function(a,b){for(var d=[],e=c.length,f=0;e>f;)c[f][a]&&c[f][a]===b?(d.push(c.splice(f,1)[0]),e--):f++;return d},this.removeAt=function(a){return a=0>a?c.length:a,c.splice(a,1)},this.removeAll=function(){return c.length=0,this},this.iterate=function(a){if(g(a))for(var b=c.length,d=0;b>d;d++)a.call(this,c[d],d,c)},this.count=function(){return c.length},this.find=function(a,b,d){function e(a,b,c){var d=a?a.valueOf():a,e=b?b.valueOf():b;d===e&&k.push(c)}function f(a){var b=i(a);return"[object String]"===b||"[object Number]"===b||"[object Boolean]"===b||"[object Date]"===b||"[object Object]"===b||"[object Undefined]"===b||"[object Null]"===b}function h(){var b,d=c.length,g="object"==typeof a&&!!a&&j(a,"key");if(b=g===!1?a:a.value,f(b))for(var h=0;d>h;h++){var i=c[h],k=c[h];g?i&&j(i,a.key)&&(k=i[a.key],e(k,b,i)):e(k,b,i)}}var k=[];return h(),b&&g(b)&&setTimeout(function(){b.call(d,k.length>0?null:new Error("not found"),k)}),k},this.getOptions=function(){return d}}function d(a){this.type="string"==typeof a?a:""}function e(a){var b=function(a,b){return function(){return j(this,a.type)?a[b]:l}};for(var d in a)j(a,d)&&g(a[d])&&(n[a.type][d]=l,c.prototype[d]=b(a,d))}function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function g(a){return"[object Function]"==={}.toString.call(a)}var h=Function.prototype.call,i=b(h,{}.toString),j=b(h,{}.hasOwnProperty),k={UNIQUEKEY:"uniqueKey"},l=function(){},m={},n={};c.prototype["implements"]=function(a,b){function d(a){return function(){return a.call(h).apply(h,arguments)}}if(this instanceof c==!1)return!1;if(!m[a])return!1;if(!/^[a-zA-Z0-9_$]+$/.test(b.name))return!1;if(this[a])return!1;var e=n[a];for(var f in e){if(j(b,f)===!1)return!1;if(g(e[f])&&g(b[f])===!1)return!1}this[a]=b;var h=this;for(f in e)if(g(e[f])){var i=c.prototype[f];this[f]=d(i)}return!0};var o={};return Object.defineProperty(o,"Basket",{get:function(){return c}}),o.create=function(a){var b;return a&&"[object Object]"===i(a)&&a[k.UNIQUEKEY]&&"string"==typeof a[k.UNIQUEKEY]&&(b={},b[k.UNIQUEKEY]=a[k.UNIQUEKEY]),new c(b)},o.plug=function(a){if(!(a instanceof d))return!1;if(m[a.type])return!1;for(var b in a)if(!j(a,b)||j(c.prototype,b))return!1;return m[a.type]=a.type,n[a.type]={name:"string"},c.prototype["I"+a.type.toUpperCase()]=m[a.type],e(a),!0},o.lose=function(a){var b=n[a];for(var d in b)j(b,d)&&g(b[d])&&j(c.prototype,d)&&delete c.prototype[d];delete m[a],delete c.prototype["I"+a.toUpperCase()],delete n[a]},o.getBasePluginWrapper=function(a){return new d(a)},o});
